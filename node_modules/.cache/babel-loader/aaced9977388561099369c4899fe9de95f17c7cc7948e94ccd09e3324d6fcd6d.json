{"ast":null,"code":"import _objectSpread from\"/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useEffect,useState}from\"react\";import{CartItem}from\"../models/cart-item\";import{jsx as _jsx}from\"react/jsx-runtime\";export var AppContext=/*#__PURE__*/createContext();var AppContextProvider=function AppContextProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),liquors=_useState2[0],setLiquors=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchInput=_useState4[0],setSearchInput=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),reviews=_useState6[0],setReviews=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cart=_useState8[0],setCart=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),name=_useState10[0],setName=_useState10[1];// Our Hosted backend APIs.\nvar liquorsApi=\"http://localhost:9292/liquors\";var reviewsApi=\"http://localhost:9292/reviews\";var getCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var parsedCart,stringedCart,parsed;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:parsedCart=localStorage.getItem('cart');if(parsedCart){_context.next=9;break;}_context.next=4;return JSON.stringify([]);case 4:stringedCart=_context.sent;localStorage.setItem('cart',stringedCart);setCart([]);_context.next=13;break;case 9:_context.next=11;return JSON.parse(parsedCart);case 11:parsed=_context.sent;setCart(parsed);case 13:case\"end\":return _context.stop();}}},_callee);}));return function getCartHandler(){return _ref2.apply(this,arguments);};}();// const getUserName = () => {\n//   const foundUser = localStorage.getItem('user')\n//   if(!foundUser) return false\n//   if(foundUser) {\n//     setName(foundUser)\n//     return true\n//   }\n// }\nuseEffect(function(){getCartHandler();//eslint-disable-next-line\n},[]);useEffect(function(){if(searchInput.length>0){setLiquors(function(prevItems){return prevItems.filter(function(liquor){return liquor.title.toLowerCase().includes(searchInput.toLowerCase());});});}else{fetch(liquorsApi).then(function(res){return res.json();}).then(function(data){return setLiquors(data);}).catch(console.log);fetch(reviewsApi).then(function(res){return res.json();}).then(function(data){return setReviews(data);}).catch(console.log);}},[searchInput,reviews]);var wines=liquors.filter(function(liquor){return liquor.category===\"Wines\";});var whiskeys=liquors.filter(function(liquor){return liquor.category===\"Whiskey\";});var vodkas=liquors.filter(function(liquor){return liquor.category===\"Vodka\";});var gins=liquors.filter(function(liquor){return liquor.category===\"Gin\";});var handleSearch=function handleSearch(e){return setSearchInput(e.target.value);};var handleDelete=function handleDelete(e){fetch(reviewsApi+\"/\".concat(e.target.id),{method:\"DELETE\"});setReviews(reviews);};function addToCart(_x,_x2){return _addToCart.apply(this,arguments);}function _addToCart(){_addToCart=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(liquor,method){var foundItem,cartToParse,newCartItem,foundItemIndex,updatedCartItem,updatedCart,_foundItemIndex,_updatedCartItem,_updatedCart,stringCart;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:foundItem=cart.find(function(item){return item.id===liquor.id;});cartToParse=cart;if(!foundItem){newCartItem=new CartItem(liquor.id,liquor.title,1,liquor[\"image_url\"],liquor.price,liquor.price);cartToParse=[].concat(_toConsumableArray(cart),[newCartItem]);setCart(function(prevCart){return[].concat(_toConsumableArray(prevCart),[newCartItem]);});}else if(foundItem){if(method==='increase'){foundItemIndex=cart.findIndex(function(item){return item.id===foundItem.id;});updatedCartItem=_objectSpread(_objectSpread({},foundItem),{},{totalAmount:foundItem.totalAmount+foundItem.price,quantity:foundItem.quantity+1});updatedCart=cart;updatedCart[foundItemIndex]=updatedCartItem;cartToParse=updatedCart;setCart(updatedCart);}else if(method==='decrease'){if(foundItem.quantity===1){cartToParse=cart.filter(function(cItem){return cItem.id!==foundItem.id;});setCart(function(prevCart){return prevCart.filter(function(cartItem){return cartItem.id!==foundItem.id;});});}else if(foundItem.quantity>1){_foundItemIndex=cart.findIndex(function(item){return item.id===foundItem.id;});_updatedCartItem=_objectSpread(_objectSpread({},foundItem),{},{totalAmount:foundItem.totalAmount-foundItem.price,quantity:foundItem.quantity-1});_updatedCart=cart;cartToParse=_updatedCart;_updatedCart[_foundItemIndex]=_updatedCartItem;}}}_context2.next=5;return JSON.stringify(cartToParse);case 5:stringCart=_context2.sent;localStorage.setItem('cart',stringCart);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return _addToCart.apply(this,arguments);}var value={name:name,setName:setName,wines:wines,cart:cart,liquors:liquors,handleSearch:handleSearch,handleDelete:handleDelete,reviews:reviews,addToCart:addToCart,whiskeys:whiskeys,gins:gins,vodkas:vodkas};return/*#__PURE__*/_jsx(AppContext.Provider,{value:value,children:children});};export default AppContextProvider;","map":{"version":3,"names":["createContext","useEffect","useState","CartItem","AppContext","AppContextProvider","children","liquors","setLiquors","searchInput","setSearchInput","reviews","setReviews","cart","setCart","name","setName","liquorsApi","reviewsApi","getCartHandler","parsedCart","localStorage","getItem","JSON","stringify","stringedCart","setItem","parse","parsed","length","prevItems","filter","liquor","title","toLowerCase","includes","fetch","then","res","json","data","catch","console","log","wines","category","whiskeys","vodkas","gins","handleSearch","e","target","value","handleDelete","id","method","addToCart","foundItem","find","item","cartToParse","newCartItem","price","prevCart","foundItemIndex","findIndex","updatedCartItem","totalAmount","quantity","updatedCart","cItem","cartItem","stringCart"],"sources":["/home/patoranking/Documents/moringa/booze-bodega/the-booze-bodega/src/services/app-context.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\nimport { CartItem } from \"../models/cart-item\";\n\nexport const AppContext = createContext();\n\nconst AppContextProvider = ({ children }) => {\n    const [liquors, setLiquors] = useState([])\n  const [searchInput , setSearchInput] = useState('')\n  const [reviews, setReviews] = useState([])\n  const [cart, setCart] = useState([]);\n  const [name, setName] = useState('');\n\n\n  // Our Hosted backend APIs.\n\n  const liquorsApi = \"http://localhost:9292/liquors\"\n  \n  const reviewsApi = \"http://localhost:9292/reviews\"\n  \n\n  const getCartHandler = async () => {\n    const parsedCart = localStorage.getItem('cart')\n    if(!parsedCart) {\n     const stringedCart = await JSON.stringify([])\n     localStorage.setItem('cart', stringedCart)\n     setCart([])\n    }\n    else {\n      const parsed = await JSON.parse(parsedCart)\n      setCart(parsed)\n    }\n  }\n\n  // const getUserName = () => {\n  //   const foundUser = localStorage.getItem('user')\n  //   if(!foundUser) return false\n  //   if(foundUser) {\n  //     setName(foundUser)\n  //     return true\n  //   }\n  // }\n\n  useEffect(() => {\n    getCartHandler()\n    //eslint-disable-next-line\n  }, []);\n\n\n  useEffect(() => {\n\n    if (searchInput.length > 0){\n      setLiquors(prevItems => prevItems.filter(liquor => liquor.title.toLowerCase().includes(searchInput.toLowerCase())));\n    } else {\n      fetch(liquorsApi).then(res=> res.json()).then(data => setLiquors(data)).catch(console.log)\n      fetch(reviewsApi).then(res=> res.json()).then(data => setReviews(data)).catch(console.log)\n    } \n   }, [searchInput, reviews])\n  \n  const wines = liquors.filter( liquor => liquor.category === \"Wines\" )\n  const whiskeys = liquors.filter( liquor => liquor.category === \"Whiskey\" )\n  const vodkas = liquors.filter( liquor => liquor.category === \"Vodka\" )\n  const gins = liquors.filter( liquor => liquor.category === \"Gin\" )\n\n  const handleSearch = e => setSearchInput(e.target.value)\n\n  const handleDelete = e => {\n    fetch(reviewsApi+`/${e.target.id}`,{\n      method: \"DELETE\",\n    })\n    setReviews(reviews)\n  }\n\n  async function addToCart(liquor, method) {\n    const foundItem = cart.find(item => item.id === liquor.id)\n    let cartToParse = cart\n    if(!foundItem) {\n        const newCartItem = new CartItem(liquor.id, liquor.title, 1, liquor[\"image_url\"], liquor.price, liquor.price )\n        cartToParse = [...cart, newCartItem]\n        setCart(prevCart => [...prevCart, newCartItem])\n    }\n    else if(foundItem) {\n        if(method === 'increase') {\n            const foundItemIndex = cart.findIndex((item) => item.id === foundItem.id)\n            const updatedCartItem = { ...foundItem, totalAmount: foundItem.totalAmount + foundItem.price, quantity: foundItem.quantity + 1 }\n            const updatedCart = cart\n            updatedCart[foundItemIndex] = updatedCartItem\n            cartToParse = updatedCart\n            setCart(updatedCart)\n        } else if(method === 'decrease') {\n            if(foundItem.quantity === 1) {\n                cartToParse = cart.filter(cItem => cItem.id !== foundItem.id)\n                setCart(prevCart => prevCart.filter((cartItem) => cartItem.id !== foundItem.id))\n            } else if(foundItem.quantity > 1) {\n                const foundItemIndex = cart.findIndex((item) => item.id === foundItem.id)\n                const updatedCartItem = { ...foundItem, totalAmount: foundItem.totalAmount - foundItem.price, quantity: foundItem.quantity - 1 }\n                const updatedCart = cart\n                cartToParse = updatedCart\n                updatedCart[foundItemIndex] = updatedCartItem\n            }\n        }\n    }\n    const stringCart = await JSON.stringify(cartToParse)\n    localStorage.setItem('cart', stringCart)\n}\n    const value = { name, setName, wines, cart, liquors, handleSearch, handleDelete, reviews, addToCart, whiskeys, gins, vodkas }\n    return <AppContext.Provider value={value}>{children}</AppContext.Provider>\n}\n\nexport default AppContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}