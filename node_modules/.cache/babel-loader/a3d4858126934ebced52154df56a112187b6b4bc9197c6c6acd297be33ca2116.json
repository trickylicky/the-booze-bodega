{"ast":null,"code":"import _objectSpread from\"/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useEffect,useState}from\"react\";import{CartItem}from\"../models/cart-item\";import{jsx as _jsx}from\"react/jsx-runtime\";export var AppContext=/*#__PURE__*/createContext();var AppContextProvider=function AppContextProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),liquors=_useState2[0],setLiquors=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchInput=_useState4[0],setSearchInput=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),reviews=_useState6[0],setReviews=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cart=_useState8[0],setCart=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),name=_useState10[0],setName=_useState10[1];// Our Hosted backend APIs.\nvar liquorsApi=\"https://fierce-gorge-06316.herokuapp.com/liquors\";var reviewsApi=\"https://fierce-gorge-06316.herokuapp.com/reviews\";var getCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var parsedCart,stringedCart,parsed;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:parsedCart=localStorage.getItem('cart');if(parsedCart){_context.next=9;break;}_context.next=4;return JSON.stringify([]);case 4:stringedCart=_context.sent;localStorage.setItem('cart',stringedCart);setCart([]);_context.next=13;break;case 9:_context.next=11;return JSON.parse(parsedCart);case 11:parsed=_context.sent;setCart(parsed);case 13:case\"end\":return _context.stop();}}},_callee);}));return function getCartHandler(){return _ref2.apply(this,arguments);};}();var getUserName=function getUserName(){var foundUser=localStorage.getItem('user');if(!foundUser)return false;if(foundUser){setName(foundUser);return true;}};useEffect(function(){getCartHandler();fetch(reviewsApi).then(function(res){return res.json();}).then(function(data){return setReviews(data);}).catch(console.log);//eslint-disable-next-line\n},[]);useEffect(function(){if(searchInput.length>0){setLiquors(function(prevItems){return prevItems.filter(function(liquor){return liquor.title.toLowerCase().includes(searchInput.toLowerCase());});});}else{fetch(liquorsApi).then(function(res){return res.json();}).then(function(data){return setLiquors(data);}).catch(console.log);}},[searchInput]);var wines=liquors.filter(function(liquor){return liquor.category===\"Wines\";});var whiskeys=liquors.filter(function(liquor){return liquor.category===\"Whiskey\";});var vodkas=liquors.filter(function(liquor){return liquor.category===\"Vodka\";});var gins=liquors.filter(function(liquor){return liquor.category===\"Gin\";});var handleSearch=function handleSearch(e){return setSearchInput(e.target.value);};function addToCart(_x,_x2){return _addToCart.apply(this,arguments);}function _addToCart(){_addToCart=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(liquor,method){var foundItem,cartToParse,newCartItem,foundItemIndex,updatedCartItem,updatedCart,_foundItemIndex,_updatedCartItem,_updatedCart,stringCart;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:foundItem=cart.find(function(item){return item.id===liquor.id;});cartToParse=cart;if(!foundItem){newCartItem=new CartItem(liquor.id,liquor.title,1,liquor[\"image_url\"],liquor.price,liquor.price);cartToParse=[].concat(_toConsumableArray(cart),[newCartItem]);setCart(function(prevCart){return[].concat(_toConsumableArray(prevCart),[newCartItem]);});}else if(foundItem){if(method==='increase'){foundItemIndex=cart.findIndex(function(item){return item.id===foundItem.id;});updatedCartItem=_objectSpread(_objectSpread({},foundItem),{},{totalAmount:foundItem.totalAmount+foundItem.price,quantity:foundItem.quantity+1});updatedCart=cart;updatedCart[foundItemIndex]=updatedCartItem;cartToParse=updatedCart;setCart(updatedCart);}else if(method==='decrease'){if(foundItem.quantity===1){cartToParse=cart.filter(function(cItem){return cItem.id!==foundItem.id;});setCart(function(prevCart){return prevCart.filter(function(cartItem){return cartItem.id!==foundItem.id;});});}else if(foundItem.quantity>1){_foundItemIndex=cart.findIndex(function(item){return item.id===foundItem.id;});_updatedCartItem=_objectSpread(_objectSpread({},foundItem),{},{totalAmount:foundItem.totalAmount-foundItem.price,quantity:foundItem.quantity-1});_updatedCart=cart;cartToParse=_updatedCart;_updatedCart[_foundItemIndex]=_updatedCartItem;}}}_context2.next=5;return JSON.stringify(cartToParse);case 5:stringCart=_context2.sent;localStorage.setItem('cart',stringCart);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return _addToCart.apply(this,arguments);}var value={name:name,setName:setName,getUserName:getUserName,wines:wines,cart:cart,liquors:liquors,handleSearch:handleSearch,reviews:reviews,addToCart:addToCart,whiskeys:whiskeys,gins:gins,vodkas:vodkas};return/*#__PURE__*/_jsx(AppContext.Provider,{value:value,children:children});};export default AppContextProvider;","map":{"version":3,"names":["createContext","useEffect","useState","CartItem","AppContext","AppContextProvider","children","liquors","setLiquors","searchInput","setSearchInput","reviews","setReviews","cart","setCart","name","setName","liquorsApi","reviewsApi","getCartHandler","parsedCart","localStorage","getItem","JSON","stringify","stringedCart","setItem","parse","parsed","getUserName","foundUser","fetch","then","res","json","data","catch","console","log","length","prevItems","filter","liquor","title","toLowerCase","includes","wines","category","whiskeys","vodkas","gins","handleSearch","e","target","value","addToCart","method","foundItem","find","item","id","cartToParse","newCartItem","price","prevCart","foundItemIndex","findIndex","updatedCartItem","totalAmount","quantity","updatedCart","cItem","cartItem","stringCart"],"sources":["/home/moringa/Documents/Moringa/Development/code/phase3/PROJECT/the-booze-bodega/src/services/app-context.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\nimport { CartItem } from \"../models/cart-item\";\n\nexport const AppContext = createContext();\n\nconst AppContextProvider = ({ children }) => {\n    const [liquors, setLiquors] = useState([])\n  const [searchInput , setSearchInput] = useState('')\n  const [reviews, setReviews] = useState([])\n  const [cart, setCart] = useState([]);\n  const [name, setName] = useState('');\n\n\n  // Our Hosted backend APIs.\n\n  const liquorsApi = \"https://fierce-gorge-06316.herokuapp.com/liquors\"\n  \n  const reviewsApi = \"https://fierce-gorge-06316.herokuapp.com/reviews\"\n  \n\n  const getCartHandler = async () => {\n    const parsedCart = localStorage.getItem('cart')\n    if(!parsedCart) {\n     const stringedCart = await JSON.stringify([])\n     localStorage.setItem('cart', stringedCart)\n     setCart([])\n    }\n    else {\n      const parsed = await JSON.parse(parsedCart)\n      setCart(parsed)\n    }\n  }\n\n  const getUserName = () => {\n    const foundUser = localStorage.getItem('user')\n    if(!foundUser) return false\n    if(foundUser) {\n      setName(foundUser)\n      return true\n    }\n  }\n\n  useEffect(() => {\n    getCartHandler()\n    fetch(reviewsApi).then(res=> res.json()).then(data => setReviews(data)).catch(console.log)\n    //eslint-disable-next-line\n  }, []);\n\n\n  useEffect(() => {\n\n    if (searchInput.length > 0){\n      setLiquors(prevItems => prevItems.filter(liquor => liquor.title.toLowerCase().includes(searchInput.toLowerCase())));\n    } else {\n      fetch(liquorsApi).then(res=> res.json()).then(data => setLiquors(data)).catch(console.log)\n    } \n   }, [searchInput])\n  \n  const wines = liquors.filter( liquor => liquor.category === \"Wines\" )\n  const whiskeys = liquors.filter( liquor => liquor.category === \"Whiskey\" )\n  const vodkas = liquors.filter( liquor => liquor.category === \"Vodka\" )\n  const gins = liquors.filter( liquor => liquor.category === \"Gin\" )\n\n  const handleSearch = e => setSearchInput(e.target.value)\n\n  async function addToCart(liquor, method) {\n    const foundItem = cart.find(item => item.id === liquor.id)\n    let cartToParse = cart\n    if(!foundItem) {\n        const newCartItem = new CartItem(liquor.id, liquor.title, 1, liquor[\"image_url\"], liquor.price, liquor.price )\n        cartToParse = [...cart, newCartItem]\n        setCart(prevCart => [...prevCart, newCartItem])\n    }\n    else if(foundItem) {\n        if(method === 'increase') {\n            const foundItemIndex = cart.findIndex((item) => item.id === foundItem.id)\n            const updatedCartItem = { ...foundItem, totalAmount: foundItem.totalAmount + foundItem.price, quantity: foundItem.quantity + 1 }\n            const updatedCart = cart\n            updatedCart[foundItemIndex] = updatedCartItem\n            cartToParse = updatedCart\n            setCart(updatedCart)\n        } else if(method === 'decrease') {\n            if(foundItem.quantity === 1) {\n                cartToParse = cart.filter(cItem => cItem.id !== foundItem.id)\n                setCart(prevCart => prevCart.filter((cartItem) => cartItem.id !== foundItem.id))\n            } else if(foundItem.quantity > 1) {\n                const foundItemIndex = cart.findIndex((item) => item.id === foundItem.id)\n                const updatedCartItem = { ...foundItem, totalAmount: foundItem.totalAmount - foundItem.price, quantity: foundItem.quantity - 1 }\n                const updatedCart = cart\n                cartToParse = updatedCart\n                updatedCart[foundItemIndex] = updatedCartItem\n            }\n        }\n    }\n    const stringCart = await JSON.stringify(cartToParse)\n    localStorage.setItem('cart', stringCart)\n}\n    const value = { name, setName, getUserName, wines, cart, liquors, handleSearch, reviews, addToCart, whiskeys, gins, vodkas }\n    return <AppContext.Provider value={value}>{children}</AppContext.Provider>\n}\n\nexport default AppContextProvider;"],"mappings":"q1BAAA,OAASA,aAAa,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,OAASC,QAAQ,KAAQ,qBAAqB,CAAC,2CAE/C,MAAO,IAAMC,WAAU,cAAGJ,aAAa,EAAE,CAEzC,GAAMK,mBAAkB,CAAG,QAArBA,mBAAkB,MAAqB,IAAfC,SAAQ,MAARA,QAAQ,CAClC,cAA8BJ,QAAQ,CAAC,EAAE,CAAC,wCAAnCK,OAAO,eAAEC,UAAU,eAC5B,eAAuCN,QAAQ,CAAC,EAAE,CAAC,yCAA5CO,WAAW,eAAGC,cAAc,eACnC,eAA8BR,QAAQ,CAAC,EAAE,CAAC,yCAAnCS,OAAO,eAAEC,UAAU,eAC1B,eAAwBV,QAAQ,CAAC,EAAE,CAAC,yCAA7BW,IAAI,eAAEC,OAAO,eACpB,eAAwBZ,QAAQ,CAAC,EAAE,CAAC,0CAA7Ba,IAAI,gBAAEC,OAAO,gBAGpB;AAEA,GAAMC,WAAU,CAAG,kDAAkD,CAErE,GAAMC,WAAU,CAAG,kDAAkD,CAGrE,GAAMC,eAAc,6FAAG,wKACfC,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAC3CF,UAAU,+CACcG,KAAI,CAACC,SAAS,CAAC,EAAE,CAAC,QAAvCC,YAAY,eAClBJ,YAAY,CAACK,OAAO,CAAC,MAAM,CAAED,YAAY,CAAC,CAC1CX,OAAO,CAAC,EAAE,CAAC,sDAGWS,KAAI,CAACI,KAAK,CAACP,UAAU,CAAC,SAArCQ,MAAM,eACZd,OAAO,CAACc,MAAM,CAAC,wDAElB,kBAXKT,eAAc,2CAWnB,CAED,GAAMU,YAAW,CAAG,QAAdA,YAAW,EAAS,CACxB,GAAMC,UAAS,CAAGT,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC9C,GAAG,CAACQ,SAAS,CAAE,MAAO,MAAK,CAC3B,GAAGA,SAAS,CAAE,CACZd,OAAO,CAACc,SAAS,CAAC,CAClB,MAAO,KAAI,CACb,CACF,CAAC,CAED7B,SAAS,CAAC,UAAM,CACdkB,cAAc,EAAE,CAChBY,KAAK,CAACb,UAAU,CAAC,CAACc,IAAI,CAAC,SAAAC,GAAG,QAAGA,IAAG,CAACC,IAAI,EAAE,GAAC,CAACF,IAAI,CAAC,SAAAG,IAAI,QAAIvB,WAAU,CAACuB,IAAI,CAAC,GAAC,CAACC,KAAK,CAACC,OAAO,CAACC,GAAG,CAAC,CAC1F;AACF,CAAC,CAAE,EAAE,CAAC,CAGNrC,SAAS,CAAC,UAAM,CAEd,GAAIQ,WAAW,CAAC8B,MAAM,CAAG,CAAC,CAAC,CACzB/B,UAAU,CAAC,SAAAgC,SAAS,QAAIA,UAAS,CAACC,MAAM,CAAC,SAAAC,MAAM,QAAIA,OAAM,CAACC,KAAK,CAACC,WAAW,EAAE,CAACC,QAAQ,CAACpC,WAAW,CAACmC,WAAW,EAAE,CAAC,GAAC,GAAC,CACrH,CAAC,IAAM,CACLb,KAAK,CAACd,UAAU,CAAC,CAACe,IAAI,CAAC,SAAAC,GAAG,QAAGA,IAAG,CAACC,IAAI,EAAE,GAAC,CAACF,IAAI,CAAC,SAAAG,IAAI,QAAI3B,WAAU,CAAC2B,IAAI,CAAC,GAAC,CAACC,KAAK,CAACC,OAAO,CAACC,GAAG,CAAC,CAC5F,CACD,CAAC,CAAE,CAAC7B,WAAW,CAAC,CAAC,CAElB,GAAMqC,MAAK,CAAGvC,OAAO,CAACkC,MAAM,CAAE,SAAAC,MAAM,QAAIA,OAAM,CAACK,QAAQ,GAAK,OAAO,GAAE,CACrE,GAAMC,SAAQ,CAAGzC,OAAO,CAACkC,MAAM,CAAE,SAAAC,MAAM,QAAIA,OAAM,CAACK,QAAQ,GAAK,SAAS,GAAE,CAC1E,GAAME,OAAM,CAAG1C,OAAO,CAACkC,MAAM,CAAE,SAAAC,MAAM,QAAIA,OAAM,CAACK,QAAQ,GAAK,OAAO,GAAE,CACtE,GAAMG,KAAI,CAAG3C,OAAO,CAACkC,MAAM,CAAE,SAAAC,MAAM,QAAIA,OAAM,CAACK,QAAQ,GAAK,KAAK,GAAE,CAElE,GAAMI,aAAY,CAAG,QAAfA,aAAY,CAAGC,CAAC,QAAI1C,eAAc,CAAC0C,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,WAEzCC,UAAS,6IAAxB,kBAAyBb,MAAM,CAAEc,MAAM,kQAC/BC,SAAS,CAAG5C,IAAI,CAAC6C,IAAI,CAAC,SAAAC,IAAI,QAAIA,KAAI,CAACC,EAAE,GAAKlB,MAAM,CAACkB,EAAE,GAAC,CACtDC,WAAW,CAAGhD,IAAI,CACtB,GAAG,CAAC4C,SAAS,CAAE,CACLK,WAAW,CAAG,GAAI3D,SAAQ,CAACuC,MAAM,CAACkB,EAAE,CAAElB,MAAM,CAACC,KAAK,CAAE,CAAC,CAAED,MAAM,CAAC,WAAW,CAAC,CAAEA,MAAM,CAACqB,KAAK,CAAErB,MAAM,CAACqB,KAAK,CAAE,CAC9GF,WAAW,8BAAOhD,IAAI,GAAEiD,WAAW,EAAC,CACpChD,OAAO,CAAC,SAAAkD,QAAQ,qCAAQA,QAAQ,GAAEF,WAAW,IAAC,CAAC,CACnD,CAAC,IACI,IAAGL,SAAS,CAAE,CACf,GAAGD,MAAM,GAAK,UAAU,CAAE,CAChBS,cAAc,CAAGpD,IAAI,CAACqD,SAAS,CAAC,SAACP,IAAI,QAAKA,KAAI,CAACC,EAAE,GAAKH,SAAS,CAACG,EAAE,GAAC,CACnEO,eAAe,gCAAQV,SAAS,MAAEW,WAAW,CAAEX,SAAS,CAACW,WAAW,CAAGX,SAAS,CAACM,KAAK,CAAEM,QAAQ,CAAEZ,SAAS,CAACY,QAAQ,CAAG,CAAC,GACxHC,WAAW,CAAGzD,IAAI,CACxByD,WAAW,CAACL,cAAc,CAAC,CAAGE,eAAe,CAC7CN,WAAW,CAAGS,WAAW,CACzBxD,OAAO,CAACwD,WAAW,CAAC,CACxB,CAAC,IAAM,IAAGd,MAAM,GAAK,UAAU,CAAE,CAC7B,GAAGC,SAAS,CAACY,QAAQ,GAAK,CAAC,CAAE,CACzBR,WAAW,CAAGhD,IAAI,CAAC4B,MAAM,CAAC,SAAA8B,KAAK,QAAIA,MAAK,CAACX,EAAE,GAAKH,SAAS,CAACG,EAAE,GAAC,CAC7D9C,OAAO,CAAC,SAAAkD,QAAQ,QAAIA,SAAQ,CAACvB,MAAM,CAAC,SAAC+B,QAAQ,QAAKA,SAAQ,CAACZ,EAAE,GAAKH,SAAS,CAACG,EAAE,GAAC,GAAC,CACpF,CAAC,IAAM,IAAGH,SAAS,CAACY,QAAQ,CAAG,CAAC,CAAE,CACxBJ,eAAc,CAAGpD,IAAI,CAACqD,SAAS,CAAC,SAACP,IAAI,QAAKA,KAAI,CAACC,EAAE,GAAKH,SAAS,CAACG,EAAE,GAAC,CACnEO,gBAAe,gCAAQV,SAAS,MAAEW,WAAW,CAAEX,SAAS,CAACW,WAAW,CAAGX,SAAS,CAACM,KAAK,CAAEM,QAAQ,CAAEZ,SAAS,CAACY,QAAQ,CAAG,CAAC,GACxHC,YAAW,CAAGzD,IAAI,CACxBgD,WAAW,CAAGS,YAAW,CACzBA,YAAW,CAACL,eAAc,CAAC,CAAGE,gBAAe,CACjD,CACJ,CACJ,CAAC,uBACwB5C,KAAI,CAACC,SAAS,CAACqC,WAAW,CAAC,QAA9CY,UAAU,gBAChBpD,YAAY,CAACK,OAAO,CAAC,MAAM,CAAE+C,UAAU,CAAC,yDAC3C,4CACG,GAAMnB,MAAK,CAAG,CAAEvC,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEa,WAAW,CAAXA,WAAW,CAAEiB,KAAK,CAALA,KAAK,CAAEjC,IAAI,CAAJA,IAAI,CAAEN,OAAO,CAAPA,OAAO,CAAE4C,YAAY,CAAZA,YAAY,CAAExC,OAAO,CAAPA,OAAO,CAAE4C,SAAS,CAATA,SAAS,CAAEP,QAAQ,CAARA,QAAQ,CAAEE,IAAI,CAAJA,IAAI,CAAED,MAAM,CAANA,MAAO,CAAC,CAC5H,mBAAO,KAAC,UAAU,CAAC,QAAQ,EAAC,KAAK,CAAEK,KAAM,UAAEhD,QAAQ,EAAuB,CAC9E,CAAC,CAED,cAAeD,mBAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}